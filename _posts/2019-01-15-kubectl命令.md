---
layout: post
title:  kubectl 命令
date:   2019-01-15 23:05:00 +0800
categories: 技术
tag: kubernetes
---


1、`创建pod`

**kubectl run NAME -\-image=image [-\-env="key=value"] [-\-port=port] [-\-replicas=replicas] [-\-dry-run=bool] [-\-command]**
 - -\-env：容器中的环境变量
 - -\-port：暴露pod的端口
 - -\-replicas：创建pod的数量
 - -\-dry-run：类似与试运行
 - -\-command：执行的命令

2、`查询pod`

**kubectl get pods [options]**
 - -n:指定namespace,例如:-n kube-system
 - -\-all-namespance:所有namespace的pod
 - -o wide:显示pod详细信息
 - -show-lables：显示标签
 - -l:筛选标签，例如：-l test,筛选标签为test的pod
 
3、`创建service`

**kubectl expose (-f FILENAME | TYPE NAME) [-\-port=port] [-\-protocol=TCP|UDP|SCTP] [-\-target-port=number-or-name]
[-\-name=name] [-\-type=type] [options]**
 - -\-port:service暴露的端口
 - -\-target-port:pod暴露的端口
 - -\-protocol:使用的协议
 - -\-type:service的类型，有4种类型：ClusterIP、NodePort、LoadBalancer or ExternalName，默认为 ClusterIP，ClusterIP只用于集群内部访问，NodePort可以将service端口映射到node上被外网访问，可以通过kubectl get svc demon查看service的类型
 
4、`删除资源`

**kubectl delete ([-f FILENAME] \| TYPE [(NAME \| -l label \| -\-all)]) [options]**

5、`输出指定的一个/多个资源的详细信息`

**kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | -l label] | TYPE/NAME) [options]**
 - -l:描述所有包含label的资源
 
6、`修改资源配置`

**kubectl edit (RESOURCE/NAME | -f FILENAME) [options]**
 - -o, -\-output="yaml": 输出格式，可选yaml或者json中的一种
 
7、`扩容或缩容控制器下pod数量`

**kubectl scale -\-replicas=COUNT (-f FILENAME \| TYPE NAME)**
 
8、`更新现有的资源对象的容器镜像`

**kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N
[options]**

可使用资源对象包括:pod、replicationcontroller、deployment、daemonset、job、replicaset 

`示例`：kubectl set image deployment/nginx busybox=busybox nginx=nginx:1.9.1

9、`对资源进行管理、回滚等`

**kubectl rollout SUBCOMMAND [options]**
 - status：查看资源回滚状态，例如：kubectl rollout status deployment nginx
 - undo:回滚版本,例如:kubectl rollout undo deployment nginx
 
10、`显示apiserver版本`

**kubectl api-versions**

11、`查看资源的yaml结构`

**kubectl explain RESOURCE [options]**

例如：kubectl explain pods.metadata.labels

12、`查看资源的运行日志`

**kubectl logs [-f] [-p] (POD | TYPE/NAME) [-c CONTAINER] [options]**
 - pod运行一个容器时：kubectl logs $podname
 - pod运行多个容器时：kubectl logs $podname $containername

13、`进入pod中的容器`

**kubectl exec -it $podname -c $containername –\- /bin/sh**




