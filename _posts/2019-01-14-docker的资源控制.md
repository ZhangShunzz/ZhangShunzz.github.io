---
layout: post
title:  docker的资源限制
date:   2019-01-14 22:08:00 +0800
categories: 技术
tag: docker
---


**查看容器使用资源的变动情况**

docker stats

**查看容器中进程使用资源的情况**

docker top $容器ID

**cpu:可压缩资源，跑满会cash**

**内存：不可压缩资源，内存跑满会kill掉进程**

docker run 的参数

内存限制（ram跟swap）
---

`-m 单位k,m,g。指定多大内存`

`--memory-swap 指定swap，必须在-m参数使用的前提下`

| --memory-swap | --memory | 功能 |
| ---- | ---- | ---- |
| 正数S | 正数M | 容器可用的内存为S，其中ram为M，swap为S-M |
| -1 | 正数M | 若宿主机启用了swap，则容器可使用最大主机的swap |
| unset | 正数M | 若宿主机启用了swap，则容器的可用swap为2XM |

`--oom-kill-disable 禁止因为out of memory 被杀掉`

`--oom-score-adj int  调整out of memory计算的优先级,(-1000,1000),优先级越低越不被kill掉`

cpu限制
---

`--cpus 2 容器最大cpu资源2核`

`--cpuset-cpus 1,3 将cpu的1，3核心分配给容器`

`--cpu-shares int  按比例共享cpu资源`
